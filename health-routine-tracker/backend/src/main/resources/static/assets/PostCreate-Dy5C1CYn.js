import{g as j,r as u,h as y,j as e,B as x}from"./index-SJ02n5JJ.js";import{c as S}from"./queries-DqIiHlpg.js";import{I as i}from"./Input-dviLJaV-.js";import{T as h}from"./Textarea-B4G9zA6W.js";import{S as b}from"./Select-z69mwp6k.js";function w(n){try{const a=localStorage.getItem(n);return a?JSON.parse(a):null}catch{return null}}function E(n,a){localStorage.setItem(n,JSON.stringify(a))}function M(n){localStorage.removeItem(n)}function N(){const n=j(),a="draft:routine:new",[t,m]=u.useState(w(a)??{date:new Date().toISOString().slice(0,10)}),[d,g]=u.useState(null),{push:p}=y();u.useEffect(()=>{E(a,t)},[t]);const o=c=>{const{name:s,value:r}=c.target;m(f=>({...f,[s]:s==="sleepHours"||s==="exerciseMinutes"||s==="waterMl"?r===""?void 0:Number(r):r}))},l=S(),v=async c=>{c.preventDefault();try{const s=await l.mutateAsync(t);try{const r=t.date??new Date().toISOString().slice(0,10);window.dispatchEvent(new CustomEvent("hrt:routine-created",{detail:r}))}catch{}M(a),p("루틴이 등록되었습니다.","success"),n(`/posts/${s.id}`)}catch(s){const r=s?.message??"ERROR";g(r),p(r,"error")}};return e.jsxs("section",{children:[e.jsx("h2",{children:"루틴 작성"}),e.jsxs("form",{onSubmit:v,style:{display:"grid",gap:12,maxWidth:640,margin:"0 auto"},children:[e.jsx(i,{label:"날짜",name:"date",type:"date",value:t.date,onChange:o,required:!0}),e.jsx(i,{label:"수면 시간(시간)",name:"sleepHours",type:"number",min:0,max:16,step:.1,value:t.sleepHours??"",onChange:o}),e.jsxs(b,{label:"운동 종류",name:"exerciseType",value:t.exerciseType??"",onChange:o,children:[e.jsx("option",{value:"",children:"선택"}),e.jsx("option",{value:"WALK",children:"WALK"}),e.jsx("option",{value:"RUN",children:"RUN"}),e.jsx("option",{value:"GYM",children:"GYM"}),e.jsx("option",{value:"ETC",children:"ETC"})]}),e.jsx(i,{label:"운동 시간(분)",name:"exerciseMinutes",type:"number",min:0,max:600,step:1,value:t.exerciseMinutes??"",onChange:o}),e.jsx(h,{label:"식사 메모(0~1000자)",name:"meals",rows:4,maxLength:1e3,value:t.meals??"",onChange:o}),e.jsx(i,{label:"물 섭취량(ml)",name:"waterMl",type:"number",min:0,max:1e4,step:50,value:t.waterMl??"",onChange:o}),e.jsx(h,{label:"노트(0~1000자)",name:"note",rows:4,maxLength:1e3,value:t.note??"",onChange:o}),d&&e.jsx("div",{className:"card",style:{color:"#ef4444"},children:d}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx(x,{type:"submit",disabled:l.isPending,children:l.isPending?"등록 중...":"등록"}),e.jsx(x,{variant:"ghost",type:"button",onClick:()=>m({date:new Date().toISOString().slice(0,10)}),children:"초기화"})]})]})]})}export{N as default};
